\documentclass[a4paper,11pt]{jsarticle}

% 数式
\usepackage{amsmath,amsfonts}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{mathtools}
\usepackage{amssymb}

% 表
\usepackage[utf8]{inputenc}
\usepackage{diagbox} % 斜線付きセルを作成するために必要
\usepackage{booktabs} % 表の罫線を美しくするために必要
\usepackage{hhline} % 水平罫線を制御するために必要

% 画像
\usepackage[dvipdfmx]{graphicx}
\usepackage{ascmac}
\usepackage{physics}
\usepackage{float} % 追加

% 図
\usepackage[dvipdfmx]{graphicx}
\usepackage{tikz} %図を描く
\usetikzlibrary{positioning, intersections, calc, arrows.meta,math} %tikzのlibrary

% ハイパーリンク
\usepackage[dvipdfm,
  colorlinks=false,
  bookmarks=true,
  bookmarksnumbered=false,
  pdfborder={0 0 0},
  bookmarkstype=toc]{hyperref}

% 式番号を章ごとにリセット
\numberwithin{equation}{section}

\begin{document}

\title{Majorization}
\author{大上由人}
\date{\today}
\maketitle

\section{古典的エントロピー及びダイバージェンス}
\subsection{古典的状態及び系}
必要な量を定義する。\\
\begin{itembox}[l]{\textbf{Def:状態を表す確率分布}}
    古典的系における状態は確率分布
    \begin{equation}
        p = (p_1, p_2, \cdots, p_d)^{\top}
    \end{equation}
    で表される。ここで、$p_i \geq 0$かつ$\sum_{i=1}^{d}p_i = 1$である。
    また、d次元の確率分布全体の集合を、$\mathcal{P}_d$と表す。\\
    また、その集合に属する一様分布を、
    \begin{equation}
        u = \left(\frac{1}{d}, \frac{1}{d}, \cdots, \frac{1}{d}\right)^{\top}
    \end{equation}
    と表す。\\
    また、異なる確率分布の積を、
    \begin{equation}
        p \otimes q \in \mathcal{P}_{dd'} \quad p \in \mathcal{P}_d, q \in \mathcal{P}_{d'}
    \end{equation}
    と表し、とくに、同じ確率分布の累乗を、
    \begin{equation}
        p^{\otimes n} \in \mathcal{P}_{d^n} \quad p \in \mathcal{P}_d
    \end{equation}
    と表す。
\end{itembox}

\begin{itembox}[l]{\textbf{Def:Supp}}
    確率分布$p ={p_i}_i \in \mathcal{P}_d$に対して、pの台を、
    \begin{equation}
        \text{spp}(p) = \{i \in [d] | p_i > 0\} \subset \{1, 2, \cdots, d\}
    \end{equation}
    と表す。また、
    \begin{equation}
        \text{rank}(p) = |\text{spp}(p)|
    \end{equation}
    を、pのランクという。とくに、$\text{rank}(p) = d$のとき、pはフルランクであるという。
\end{itembox}
要するに、確率が0でないようなインデックスの集合を台と呼び、その要素数をランクと呼ぶ。\\

\begin{itembox}[l]{\textbf{Def:確率遷移行列}}
    古典的な確率分布の時間発展は、確率遷移行列$T$を用いて以下のように表される。
    \begin{equation}
        p_i ' = \sum_{j=1} T_{ij}p_j 
    \end{equation}
\end{itembox}

\begin{itembox}[l]{\textbf{Prop:確率遷移行列の性質}}
    確率遷移行列$T$は以下の性質を持つ。
    \begin{equation}
        \sum_{i=1}^{d}T_{ij} = 1
    \end{equation}
\end{itembox}
\textbf{Prf}\\
略(確率の規格化を利用する。)\hfill \qedsymbol\\

\begin{itembox}[l]{\textbf{Def:二重確率遷移行列}}
    確率遷移行列$T$が、
    \begin{equation}
        \sum_{j=1} T_{ij} = 1
    \end{equation}
    をみたすとき、二重確率遷移行列という。
\end{itembox}
\begin{itembox}[l]{\textbf{Prop:二重確率遷移行列の特徴づけ}}
    以下の二つは同値である。
    \begin{enumerate}
        \item Tは二重確率遷移行列である。
        \item 一様分布uはTに対して不変である。すなわち、$u=Tu$である。
    \end{enumerate}
\end{itembox}
\textbf{Prf}\\
\begin{align}
    p_i ' &= \sum_{j=1} T_{ij}u_j\\
    &= \frac{1}{d}\sum_{j=1}^{d}T_{ij}\\
    &= \frac{1}{d}\cdot d\\
    &= 1
\end{align}
であることからわかる。\\

\begin{itembox}[l]{\textbf{Def:トレース距離}}
    二つの確率分布$p, q$のトレース距離は、
    \begin{equation}
        D(p, q) = \frac{1}{2}\sum_{i=1}^{d}|p_i - q_i|
    \end{equation}
    で定義される。
\end{itembox}
\begin{itembox}[l]{\textbf{Prop:トレース距離の性質}}
    トレース距離は、$T$に対して非増加である。すなわち、
    \begin{equation}
        D(p,q) \geq D(Tp, Tq)
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
後により一般の証明をするため、ここでは省略する。\\

\subsection{シャノンエントロピー及びKLダイバージェンス}
\begin{itembox}[l]{\textbf{Def:シャノンエントロピー}}
    確率分布$p \in \mathcal{P}_d$のシャノンエントロピーは、
    \begin{equation}
        S_1(p) = -\sum_{i=1}^{d}p_i\log p_i
    \end{equation}
    で定義される。
\end{itembox}
\begin{itembox}[l]{\textbf{Def:KLダイバージェンス}}
    二つの確率分布$p, q \in \mathcal{P}_d$のKLダイバージェンスは、
    \begin{equation}
        S_1(p||q) = \sum_{i=1}^{d}p_i\log\frac{p_i}{q_i}
    \end{equation}
    で定義される。ただし、$\text{supp}(p) \subset \text{supp}(q)$でないときは、$S_1(p||q) = \infty$とする。
\end{itembox}
このとき、エントロピーとKLダイバージェンスの関係がわかる。
\begin{itembox}[l]{\textbf{Prop:エントロピーとKLダイバージェンスの関係}}
    任意の$p, q \in \mathcal{P}_d$に対して、
    \begin{equation}
        S_1(p) = ln(d) - S_1(p||u)
    \end{equation}
\end{itembox}
\textbf{Prf}\\
\begin{align}
    S_1(p||u) &= \sum_{i=1}^{d}p_i\log\frac{p_i}{\frac{1}{d}}\\
    &= \sum_{i=1}^{d}p_i\log dp_i\\
    &= \sum_{i=1}^{d}p_i\log d + \sum_{i=1}^{d}p_i\log p_i\\
    &= \log d - S_1(p)
\end{align}
であることからわかる。\hfill \qedsymbol\\
これより、$S_1(p) \leq \log d$であることがわかる。\\
このとき、KLダイバージェンスのテイラー展開は以下のようになる。
\begin{align}
    S_1(p||p-\Delta p) &= \frac{1}{2}\sum_i \frac{(\Delta p_i)^2}{p_i} + O(\Delta p^3)\\
\end{align}
ここで、$\sum_i \Delta p_i = 0$を用いている。\\
%TODO後で示す。\\
\begin{itembox}[l]{\textbf{Def:monotone}}
    monotoneとは、free operationに対して、増減しない量のことである。

\end{itembox}
\begin{itembox}[l]{\textbf{Prop:KLダイバージェンスの単調性}}
    KLダイバージェンスは、$p' = Tp$および$q' = Tq$に対して、
    \begin{equation}
        S_1(p||q) \geq S_1(p'||q')
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
後に一般に示す。\\

注意されたいこととして、KLダイバージェンスの単調性の逆はいえない。すなわち、単調性を満たすが、$p' = Tp$および$q' = Tq$を満たすような$T$が存在しない場合がある。\\

次に、二重確率遷移行列について考える。このとき、KLダイバージェンスの単調性と、
\begin{equation}
    S_1(p) \leq S_1(Tp)
\end{equation}
が成り立つ。\\
すなわち、二重確率遷移行列による時間発展は、エントロピーを増加させる。\\

\begin{itembox}[l]{\textbf{Def:相互情報量}}
    二つの確率分布$p, q \in \mathcal{P}_d$の相互情報量は、
    \begin{equation}
        I_1 (p_{AB})_{A:B} = S_1 (p_A) + S_1 (p_B) - S_1 (p_{AB}) = S_1(p_{AB}||p_A \otimes p_B) \geq 0
    \end{equation}
    で定義される。
\end{itembox}
この量は、AとBの相関を表す量である。\\
\begin{itembox}[l]{\textbf{Prop:相互情報量の性質}}
    任意の$p, q \in \mathcal{P}_d$に対して、
    \begin{equation}
        I_1(p_{AB})_{A:B} =0 \Leftrightarrow p_{AB} = p_A \otimes p_B
    \end{equation}
    が成り立つ。また、KLダイバージェンスの単調性から、
    \begin{equation}
        I_1(p_{AB})_{A:B} \geq I_1(T_A \otimes T_B p_{AB})_{A:B}
    \end{equation}
    が成り立つ。ただし、$T_A \otimes T_B$は、各A,Bに独立に作用する確率遷移行列である。\\
    
\end{itembox}
\textbf{Prf}\\
略(過去のゼミ資料を参考せよ)\hfill \qedsymbol\\

\subsection{Rényiエントロピー及びダイバージェンス}
シャノンエントロピーを包含する概念として、Rényiエントロピーがある。\\
\begin{itembox}[l]{\textbf{Def:Rényiエントロピー}}
    確率分布$p \in \mathcal{P}_d$のRényiエントロピーは、$0 \leq \alpha \leq \infty$、$p \in \mathcal{P}_d$に対して、
    \begin{equation}
        S_{\alpha}(p) = \frac{1}{1-\alpha}\log(\sum_{i=1}^{d}p_i^{\alpha})
    \end{equation}
    で定義される。
\end{itembox}
また、ダイバージェンスについても、Rényiダイバージェンスがある。\\
\begin{itembox}[l]{\textbf{Def:Rényiダイバージェンス}}
    二つの確率分布$p, q \in \mathcal{P}_d$のRényiダイバージェンスは、$0 \leq \alpha \leq \infty$、$p \in \mathcal{P}_d$に対して、
    \begin{equation}
        S_{\alpha}(p||q) = \frac{1}{\alpha - 1}\log(\sum_{i=1}^{d}p_i^{\alpha}q_i^{1-\alpha})
    \end{equation}
    で定義される。ただし、$\text{supp}(p) \subset \text{supp}(q)$でないときは、$S_{\alpha}(p||q) = \infty$とする。
\end{itembox}
これらの量が、たしかにシャノンエントロピーとKLダイバージェンスを包含していることを示す。\\
\begin{itembox}[l]{\textbf{Prop:Rényiエントロピーとシャノンエントロピーの関係}}
    Rényi-1エントロピーは、シャノンエントロピーに一致する。すなわち、
    \begin{equation}
        S_1(p) = S_{\alpha}(p)|_{\alpha = 1}
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
\begin{align}
    S_{\alpha}(p)|_{\alpha = 1} &= -lim_{\alpha \to 1}\frac{1}{1-\alpha}\log(\sum_{i=1}^{d}p_i^{\alpha})\\
    &= -\frac{d}{d\alpha}\log(\sum_{i=1}^{d}p_i^{\alpha})|_{\alpha = 1}\\
    &= -\frac{\sum_{i=1}^{d}p_i\log p_i}{\sum_{i=1}^{d}p_i}\\
    &= -\sum_{i=1}^{d}p_i\log p_i\\
    &= S_1(p)
\end{align}
であることからわかる。\hfill \qedsymbol\\

\begin{itembox}[l]{\textbf{Prop:Rényiダイバージェンスとダイバージェンスの関係}}
    Rényi-1ダイバージェンスは、KLダイバージェンスに一致する。すなわち、
    \begin{equation}
        S_{\alpha}(p||q)|_{\alpha = 1} = S_1(p||q)
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
\begin{align}
    S_{\alpha}(p||q)|_{\alpha = 1} &= lim_{\alpha \to 1}\frac{1}{\alpha - 1}\log(\sum_{i=1}^{d}p_i^{\alpha}q_i^{1-\alpha})\\
    &= \frac{d}{d\alpha}\log(\sum_{i=1}^{d}p_i^{\alpha}q_i^{1-\alpha})|_{\alpha = 1}\\
    &= \frac{\sum_{i=1}^{d}q_i(p_i/q_i)^{\alpha}\log (p_i/q_i)}{\sum_{i=1}^{d}p_i^{\alpha}q_i^{1-\alpha}}|_{\alpha = 1}\\%TODOここの計算後で確認する。
    &= \sum_{i=1}^{d}p_i\log\frac{p_i}{q_i}\\
    &= S_1(p||q)
\end{align}
であることからわかる。\hfill \qedsymbol\\

また、$\alpha =0,\infty$の場合は重要らしいので、以下で確認する。
\begin{itembox}[l]{\textbf{Prop:Rényiエントロピー/ダイバージェンスの極限}}
    Rényi-0エントロピーは、
    \begin{equation}
        S_0(p) = \log (\text{rank}(p))
    \end{equation}
    で定義される。また、Rényi-$\infty$エントロピーは、
    \begin{equation}
        S_{\infty}(p) = -(\log \max_{i}p_i)
    \end{equation}
    で定義される。また、Rényi-0ダイバージェンスは、
    \begin{equation}
        S_0(p||q) = -\log (\sum_{i:p_i > 0}q_i)
    \end{equation}
    で定義される。また、Rényi-$\infty$ダイバージェンスは、
    \begin{equation}
        S_{\infty}(p||q) = \log (\max_{i}\frac{p_i}{q_i})
    \end{equation}
    で定義される。
\end{itembox}
\textbf{Prf}\\
%TODO後で示す。\alpha=0については自明\\

\begin{itembox}[l]{\textbf{Prop:RényiエントロピーとKLダイバージェンスの関係}}
    任意の$p, q \in \mathcal{P}_d$に対して、
    \begin{equation}
        S_{\alpha}(p) = \frac{1}{1-\alpha}\log d - S_{\alpha}(p||u)
    \end{equation}
    が成り立つ。
\end{itembox}

以下、Rényiダイバージェンスについての性質を示す。\\
\begin{itembox}[l]{\textbf{Prop:Rényiダイバージェンスの非負性}}
    任意の$p, q \in \mathcal{P}_d$に対して、
    \begin{equation}
        S_{\alpha}(p||q) \geq 0
    \end{equation}
    が成り立つ。また、$0 < \alpha \leq  \infty$に対して、
    \begin{equation}
        S_{\alpha}(p||q) =0 \Leftrightarrow p = q
    \end{equation}
    であり、また、$\alpha =0$のとき、
    \begin{equation}
        S_{0}(p||q) = 0 \Leftrightarrow \text{supp}(p) \subset \text{supp}(q)
    \end{equation}
    が成り立つ。
\end{itembox}

\begin{itembox}[l]{\textbf{Prop:Rényiダイバージェンスの単調性}}
    任意の$p' = Tp, q' = Tq \in \mathcal{P}_d$に対して、
    \begin{equation}
        S_{\alpha}(p||q) \geq S_{\alpha}(p'||q')
    \end{equation}
    が成り立つ。また、二重確率遷移行列に対して、
    \begin{equation}
        S_{\alpha}(p) \leq S_{\alpha}(Tp)
    \end{equation}
    が成り立つ。
\end{itembox}

\begin{itembox}[l]{\textbf{Prop:Rényiダイバージェンスの単調性(2)}}
    $\alpha \leq \alpha' $に対して、
    \begin{equation}
        S_{\alpha}(p||q) \leq S_{\alpha'}(p||q)
    \end{equation}
    が成り立ち、また、
    \begin{equation}
        S_{\alpha}(p) \geq S_{\alpha'}(p)
    \end{equation}
    が成り立つ。
\end{itembox}

\begin{itembox}[l]{\textbf{Lem:}}
    fを下に凸な関数であるとし、$p,q,p',q' \in \mathbb{R}^d$がすべて正であるとする。
    もし、$p' = Tp, q' = Tq$であるとき、
    \begin{equation}
        \sum_{i=1}^{d} q_i'f\left(\frac{p_i'}{q_i'}\right) \leq \sum_{i=1}^{d} q_i f\left(\frac{p_i}{q_i}\right)
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
Jensenの不等式より、
\begin{equation}
    \sum_{j=1}^{d}q_j'f\left(\frac{p_j'}{q_j'}\right) \leq \sum_{j=1}^{d}\sum_{i=1}^{d}\frac{T_{ji}q_i}{q_j'}f\left(\frac{p_i}{q_i}\right)=\sum_{i=1}^{d}q_i f\left(\frac{p_i}{q_i}\right)
\end{equation}
である。\hfill \qedsymbol\\
ここで、$p,q \in \mathcal{P}_d$として、$f(x)=xlogx$とすると、
\begin{equation}
    S_1 (p||q) \geq S_1 (p'||q')
\end{equation}
が成り立つ。これは、KLダイバージェンスの単調性を示している。\\

\textbf{Prf:(Rényiダイバージェンスの非負性)}\\
$f_{\alpha}(x) = x^{\alpha}$とすると、$1<\alpha \leq \infty$に対して、$f_{\alpha}(x)$は下に凸な関数である。\\
Jensenの不等式より
\begin{equation}
    \sum_{i=1}^{d}q_i f(\frac{p_i}{q_i}) \geq f(\sum_{i=1}^{d}q_i \frac{p_i}{q_i}) = f(1) = 0
\end{equation}
である。両辺対数をとることにより、
\begin{equation}
    \log(\sum_{i=1}^{d}q_i \frac{p_i}{q_i}) \geq 0
\end{equation}
である。これを両辺$\frac{1}{\alpha - 1}$かけることにより、
\begin{equation}
    \frac{1}{\alpha - 1}\log(\sum_{i=1}^{d}q_i \frac{p_i}{q_i}) \geq 0
\end{equation}
である。したがって、
\begin{equation}
    S_{\alpha}(p||q) \geq 0
\end{equation}
である。また、$0 < \alpha <1$のときは、上のJensenの不等式で不等号が逆になり、$\frac{1}{\alpha-1}$をかけるときにもう一度符号が逆になることに注意して、同様に示すことができる。\\
$\alpha =0,1,\infty$の場合は、それぞれの定義から自明である。\\  
\hfill \qedsymbol\\

\textbf{Prf:(Rényiダイバージェンスの単調性)}\\
$1<\alpha <\infty$のとき、Lemで、$f(x) = x^{\alpha}$として示した不等式を用いると、
\begin{equation}
    \sum_{i=1}^{d}q_i'\frac{p_i'^{\alpha}}{q_i'^{\alpha}} \leq \sum_{i=1}^{d}q_i\frac{p_i^{\alpha}}{q_i^{\alpha}}
\end{equation}
である。これの両辺対数をとることにより、
\begin{equation}
    \log(\sum_{i=1}^{d}p_i'^{\alpha}q_i^{1-\alpha}) \leq \log(\sum_{i=1}^{d}p_i^{\alpha}q_i^{1-\alpha})
\end{equation}
である。したがって、
\begin{equation}
    \frac{1}{\alpha - 1}\log(\sum_{i=1}^{d}p_i'^{\alpha}q_i^{1-\alpha}) \leq \frac{1}{\alpha - 1}\log(\sum_{i=1}^{d}p_i^{\alpha}q_i^{1-\alpha})
\end{equation}
である。したがって、
\begin{equation}
    S_{\alpha}(p||q) \geq S_{\alpha}(p'||q')
\end{equation}
である。\\
$0<\alpha <1$のときは、同様に示すことができる。\\
$\alpha =0,1,\infty$の場合は、それぞれの定義から自明である。\\
\hfill \qedsymbol\\

\textbf{Prf:(Rényiダイバージェンスの単調性(2))}\\
$\alpha \leq \alpha'$に対して、$f(x) =x^{\frac{\alpha-1}{\alpha'-1}}$とすると、この関数は、$1<\alpha <\alpha'<\infty$に対して下に凸な関数であり、$0<\alpha<\alpha'<1$および$0<\alpha<1<\alpha'$に対して上に凸な関数である。\\
したがって、Jensenの不等式より、
\begin{align}
    S_{\alpha}(p||q) &= \frac{1}{\alpha - 1}\log(\sum_{i=1} p_i\left(\frac{p_i}{q_i}\right)^{\alpha-1})\\
    &= \frac{1}{\alpha - 1}\log(\sum_{i=1} p_i\left(\frac{p_i}{q_i}\right)^{(alpha'-1)(\frac{\alpha-1}{\alpha'-1})})\\
    &\leq \frac{1}{\alpha' - 1}\log(\sum_{i=1} p_i\left(\frac{p_i}{q_i}\right)^{\alpha'-1})\\
    &= S_{\alpha'}(p||q)
\end{align}
である。\\
また、$\alpha=0,1,\infty$の場合は、それぞれの定義から自明である。\\
\hfill \qedsymbol\\

さらに、f-ダイバージェンスという概念がある。\\
\begin{itembox}[l]{\textbf{Def:f-ダイバージェンス}}
    $f(0, \infty) \to \mathbb{R}$を下に凸な関数とし、$x=1$で$f(x)$が狭義凸かつ$f(1)=0$であるとする。このとき、$p, q \in \mathcal{P}_d$に対して、
    \begin{equation}
        D_f(p||q) = \sum_{i=1}^{d}q_i f\left(\frac{p_i}{q_i}\right)
    \end{equation}
    で定義される。
\end{itembox}

KLダイバージェンスは、$f(x) = x\log x$のときのf-ダイバージェンスである。また、Rényiダイバージェンスは、$f(x) = x^{\alpha}$としてlogをとって$\frac{1}{\alpha - 1}$をかけたものである。\\

\begin{itembox}[l]{\textbf{Prop:f-ダイバージェンスの非負性}}
    任意の$p, q \in \mathcal{P}_d$に対して、
    \begin{equation}
        D_f(p||q) \geq 0
    \end{equation}
    が成り立つ。また、
    \begin{equation}
        D_f(p||q) = 0 \Leftrightarrow p = q
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
Jensenの不等式より、
\begin{equation}
    \sum_{i=1}^{d}q_i f\left(\frac{p_i}{q_i}\right) \geq f\left(\sum_{i=1}^{d}q_i \frac{p_i}{q_i}\right) = f(1) = 0
\end{equation}
である。ことからわかる。\hfill \qedsymbol\\

\begin{itembox}[l]{\textbf{Prop:f-ダイバージェンスの単調性}}
    任意の$p' = Tp, q' = Tq \in \mathcal{P}_d$に対して、
    \begin{equation}
        D_f(p||q) \geq D_f(p'||q')
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
よくよく見ると、これはLemで示した不等式と同じである。\hfill \qedsymbol\\


\subsection{フィッシャー情報量}
%TODO地の文を書く。
以下、我々は、なめらかにパラメータ化された確率分布$p(\theta)$について考える。ただし、$\theta$の取りうる領域は、$\mathbb{R}^m$の開部分集合である。\\
\begin{itembox}[l]{\textbf{Def:フィッシャー情報量}}
    $p(\theta) \in \mathcal{P}_d$がフルランクであるとし、$\theta \in \mathbb{R}^m$をパラメータとする。このとき、フィッシャー情報量は$m \times m$行列で、
    \begin{equation}
        J_{p(\theta),kl} = \sum_{i=1}^{d}p_i(\theta)\partial_k[ \log p_i(\theta)]\partial_l[ \log p_i(\theta)] = \sum_{i=1}^{d}\frac{\partial_k p_i(\theta)\partial_l p_i(\theta)}{p_i(\theta)}
    \end{equation}
    で定義される。
\end{itembox}
フィッシャー情報量は、f-ダイバージェンスの極限として得られる。%TODO後で書く。\\

\begin{itembox}[l]{\textbf{Prop:フィッシャー情報量の単調性}}
    任意の確率遷移行列$T$に対して、
    \begin{equation}
        J_{p(\theta)} \geq J_{Tp(\theta)}
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
$p' = Tp$とし、$c=(c^1,...,c^m)\in \mathbb{R}^m$として、$\partial = \sum_k c^k \partial_k$とする。このとき、
\begin{align}
    c^{\top}J_{p(\theta)}c &= \sum_{i} p_i \left(\frac{\partial p_i}{p_i}\right)^2\\
    c^{\top}J_{p'(\theta)}c &= \sum_{i} p_i' \left(\frac{\partial p_i'}{p_i'}\right)^2\\
\end{align}
である。%TODOよくわかんない。\\
したがって、Lemmaで$f=x^2$として示した不等式より、
\begin{equation}
    c^{\top}J_{p(\theta)}c \geq c^{\top}J_{p'(\theta)}c
\end{equation}
である。したがって、
\begin{equation}
    J_{p(\theta)} \geq J_{Tp(\theta)}
\end{equation}
である。\hfill \qedsymbol\\
フィッシャー情報量の操作的な意味付けとして、Cramér-Raoの不等式がある。\\
\begin{itembox}[l]{\textbf{Thm:Cramér-Raoの不等式}}
    あるパラメータ$\theta$に対する不偏推定量 $\theta_{est}$に対して、不偏条件$\sum_{i=1}^{d}p_i(\theta)\theta_{est}(i) = \theta$が成り立つとする。このとき、正確さは共分散行列
    \begin{equation}
        Cov_{\theta}^{kl}(\theta_{est})=\sum_{i=1} p_i(\theta)(\theta_{est}^k(i)-\theta^k)(\theta_{est}^l(i)-\theta^l) 
    \end{equation}
    により表現される。このとき、
    \begin{equation}
        \text{Cov}_{\theta}^{kl}(\theta_{est}) \geq (J_{p(\theta)})^{-1}_{kl}
    \end{equation}
    が成り立つ。
\end{itembox}
すなわち、フィッシャー情報量は、$\theta$の不偏推定量が、フィッシャー情報量によって制限されることを示している。\\

例として、指数型分布族とよばれる確率分布の集合族を考える。簡単のために、パラメータを$\theta$のみとし、
\begin{equation}
    p_i(\theta) = h_i\exp(\theta T_i - A(\theta))
\end{equation}
であるとする。ただし、$A(\theta)$は、$\theta$のなめらかな関数である。このとき、簡単な計算により、
\begin{equation}
    \sum_{i=1} T_i p_i(\theta) = A'(\theta) \quad \sum_{i=1} T_i^2 p_i(\theta) = A''(\theta)+A'(\theta)^2
\end{equation}
である。したがって%あとで計算確認
\begin{equation}
    J_{p(\theta)} = A''(\theta)
\end{equation}
である。\\
熱力学の文脈では、$p_i(\theta)$をギブス分布、$T_i$をエネルギーとして、$-\theta$を逆温度として解釈することができる。そして、$\theta ^{-1}A(\theta)$は、自由エネルギーである。すなわち、
\begin{equation}
    p_i(\theta) = \frac{1}{Z(\theta)}\exp(-\theta E_i)
\end{equation}
である。\\
また、(\ref{umbiased})は、$T_i$が、$A'(\theta)$の不偏推定量であることを示している。
それに対応するフィッシャー情報量は、$J_{p(\theta)} = A''(\theta)^{-1}$である。というのも、$\dv{\theta'}=(A''(\theta))^{-1}\dv{\theta}$であるからである。\\


また、情報幾何の文脈では、フィッシャー情報量は、確率分布空間の計量として考えられる。以下では、monotone計量という概念を導入する。\\
\begin{itembox}[l]{\textbf{Def:Monotone計量}}
    $G_p: \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}$が、フルランクの$p \in \mathcal{P}_d$に対して、以下を満たすとき、$G_p$はMonotone計量であるという。
    \begin{itemize}
        \item $G_p$は双線形である。
        \item $G_p(a,a)\geq 0$であり、$G_p(a,a) = 0 \Leftrightarrow a = 0$である。
        \item $p \mapsto G_p(a,a)$は任意の$a$に対して連続である。
        \item 任意の$T,a,p$に対して、$G_{p}(a,a) \geq G_{Tp}(Ta,Ta)$が成り立つ。
    \end{itemize}
\end{itembox}
このとき、特にフィッシャー情報計量は、
\begin{equation}
    \label{umbiased}
    G_p^F (a,b) = \sum_{i=1}^{d}\frac{a_i b_i}{p_i}
\end{equation}
で定義される。ただし、$a=(a_1,...,a_d), b=(b_1,...,b_d)$である。\\
この計量は、フィッシャー情報量行列と、
\begin{equation}
    J_{p(\theta),kl} = G_{p(\theta)}^F (\partial_k p(\theta), \partial_l p(\theta))
\end{equation}
との関係がある。\\

\begin{itembox}[l]{\textbf{Prop:フィッシャー情報量計量の単調性}}
    任意の確率遷移行列$T$に対して、
    \begin{equation}
        G_p^F (a,a) \geq G_{Tp}^F (Ta,Ta)
    \end{equation}
    が成り立つ。
\end{itembox}
\textbf{Prf}\\
%TODO後で書く。\\

逆に、任意のmonotone計量は、フィッシャー情報量計量を用いて、以下のように表現できる。\\
\begin{itembox}[l]{\textbf{Thm:Chentsovの定理}}
    任意のmonotone計量$G_p$は、フィッシャー情報量計量を用いて、
    \begin{equation}
        G_p(a,b) = kG_p^F (a,b)+k'(\sum_{i=1}^{d}a_i)(\sum_{i=1}^{d}b_i)
    \end{equation}
    と表現できる。ただし、$k,k' \geq 0$である。
\end{itembox}
\textbf{Prf}\\
略\\

\section{Classical Majorization}
状態の遷移可能性は、majorizationによって、必要十分に特徴づけられる。\\
\subsection{Majorization}
\begin{itembox}[l]{\textbf{Def:Majorization}}
    $p,p' \in \mathcal{P}_d$に対して、$p$が$p'$をmajorizeすることを、$p' \prec p$と書き、
    \begin{equation}
        \forall k \in \{1,...,d\} \quad \sum_{i=1}^{k}{p'}_i^{\downarrow} \leq \sum_{i=1}^{k}p_i^{\downarrow}
    \end{equation}
    が成り立つとき、$p$が$p'$をmajorizeするという。ただし、$p^{\downarrow}$は、$p$の要素を降順に並べたものである。
\end{itembox}
Majorizationは、$p$と$p'$の確率分布を比較したときに、ばらつきの大きさを比較する量である。\\
Majorizationを図に表すと、以下のローレンツ曲線で表現される。\\
\begin{figure}[H]
    \begin{center}
    \includegraphics[width=100mm]{image1.png}
    \end{center}
    \caption{Majorizationの図示}
    \label{fig:one}
\end{figure}
図でいうところの、下に来ている曲線が、よりばらつきが小さい確率分布であり、とくに一様分布のときは直線になることがわかる。すなわち、
\begin{equation}
    u \prec p \quad \forall p \in \mathcal{P}_d
\end{equation}
である。\\
注意すべきこととして、この$\prec$は全順序ではない。すなわち、ある確率分布の組$p,p'$に対して、$p \prec p'$か$p' \prec p$のどちらも成り立たない場合がある。このとき、ローレンツ曲線は交わる。\\

\begin{itembox}[l]{\textbf{Thm:Majorizationの特徴づけ}}
    $p,p' \in \mathcal{P}_d$に対して、以下は同値である。
    \begin{enumerate}
        \item $p' \prec p$
        \item $\forall t\in \mathbb{R} \quad \sum_{i=1}^{d}|p_i'-t| \leq \sum_{i=1}^{d}|p_i-t|$
        \item 任意の下に凸な関数$f$に対して、
        \begin{equation}
            \sum_{i=1}^{d}f(p_i') \leq \sum_{i=1}^{d}f(p_i)
        \end{equation}
        \item $p' = Tp$となる二重確率遷移行列$T$が存在する。
    \end{enumerate}
\end{itembox}
\textbf{Prf}\\
この証明は後で行う。\\

\textbf{3についての補足}
%後で書く。\\

また、一様分布は、二重確率遷移行列のもとで不変である。熱力学の文脈では、uは高温極限をとった時のGibbs分布に対応している。このとき、二重確率遷移行列は、そのようなGibbs分布を保つものである。\\

\begin{itembox}[l]{\textbf{Thm:Birkhoffの定理}}
    以下の二つは同値である。
    \begin{enumerate}
        \item $T$は二重確率遷移行列である。
        \item $T$は、置換行列の凸結合で表現できる。すなわち、
        \begin{equation}
            T = \sum_{k} r_k P_k
        \end{equation}
        である。ただし、$r_k \geq 0$であり、$\sum_k r_k = 1$である。また、$P_k$は、置換行列である。
    \end{enumerate}
\end{itembox}
\textbf{Prf}\\
教科書で証明されていないので一旦飛ばす。\\

\begin{itembox}[l]{\textbf{Prop:二重確率遷移行列の性質}}
    \begin{equation}
        「Tが二重確率遷移行列である」 \Leftrightarrow Tp \prec p \quad \forall p \in \mathbb{R}^d
    \end{equation}
\end{itembox}
\textbf{Prf}\\
%後で書く。\\

\begin{itembox}[l]{\textbf{Def:Schur凸性}}
    $F: \mathbb{R}^d \to \mathbb{R}$がSchur凸であるとは、
    \begin{equation}
        \forall p,p' \in \mathcal{P}_d \quad p' \prec p \Rightarrow F(p') \leq F(p)
    \end{equation}
    が成り立つことである。言い換えると、Schur凸な関数は、majorizationに関して単調である。
\end{itembox}

\begin{itembox}[l]{\textbf{Prop:}}
    $F: \mathbb{R}^d \to \mathbb{R}$がSchur凸かつ微分可能なことと、Fが転置に対して不変なこと、すなわち、
    \begin{equation}
        F(p) = F(Pp) \quad \forall p ,P
    \end{equation}
    が成り立つことは同値であり、また、
    \begin{equation}
        \forall p \in \mathcal{P}_d \quad (p_ip_j)\left(\pdv{F}{p_i}-\pdv{F}{p_j}\right)\geq 0
    \end{equation}
    も同値である。
\end{itembox}
\textbf{Prf}\\
%後で書く。\\

\subsection{d-MajorizationとThermo-Majorization}
先ほどまでは、一つの分布についての遷移について考えていたが、次は、二つの分布の組の遷移を考える。\\
このとき、$p^*=(p_1^*,...,p_d^*)^{\top},q^*=(q_1^*,...,q_d^*)^{\top}$を、$p=(p_1,...,p_d)^{\top},q=(q_1,...,q_d)^{\top}$を
$\frac{p_1^*}{q_1^*} \geq \frac{p_2^*}{q_2^*} \geq ... \geq \frac{p_d^*}{q_d^*}$が成り立つように並べ替えたものとして定義する。この新しく定義した$p^*,q^*$に対して
横軸を$\sum_{i=1}^{k}q_i^*$、縦軸を$\sum_{i=1}^{k}p_i^*$としたローレンツ曲線を考える。図は以下のようになる。\\
\begin{figure}[H]
    \begin{center}
    \includegraphics[width=100mm]{image2.png}
    \end{center}
    \caption{d-Majorizationの図示}
    \label{fig:two}
\end{figure}

\begin{itembox}[l]{\textbf{Def:d-Majorization}}
    $p,q,p',q' \in \mathcal{P}_d$に対して、
    \begin{equation}
        (p',q') \prec (p,q) \Leftrightarrow 「(p,q) \text{のローレンツ曲線が}(p',q') \text{のローレンツ曲線の上に来る」}
    \end{equation}
    が成り立つとき、$(p,q)$は$(p',q')$をd-majorizeするという。
\end{itembox}
d-majorizationは、以下のような言いかえが可能である。\\
\begin{itembox}[l]{\textbf{Thm:Bkackwellの定理}}
    $p,q,p',q' \in \mathcal{P}_d$かつ$q,q'$がフルランクであるとき、以下は同値である。
    \begin{enumerate}
        \item $(p',q') \prec (p,q)$
        \item 
        \begin{equation}
            \forall t \in \mathbb{R} \quad \sum_{i=1}^{d}|p_i'-tq_i'| \leq \sum_{i=1}^{d}|p_i-tq_i|
        \end{equation}
        \item 任意の下に凸な関数$f$に対して、
        \begin{equation}
            \sum_{i=1}^{d} q_i'f(\frac{p_i'}{q_i'}) \leq \sum_{i=1}^{d} q_i f(\frac{p_i}{q_i})
        \end{equation}
        \item ある二重確率遷移行列$T$が存在して、
        \begin{equation}
            p' = Tp \quad q' = Tq
        \end{equation}
        が成り立つ。
    \end{enumerate}
\end{itembox}
\textbf{Prf}\\
後で証明を行う。\\

%TODO地の文を書く。

\begin{itembox}[l]{\textbf{Def:Thermo-Majorization}}
    $p,q,p' \in \mathcal{P}_d$に対して、pがqについてp'をthermo-majorizeするとは、
    \begin{equation}
        (p',q) \prec (p,q)
    \end{equation}
    が成り立つことである。
\end{itembox}
$(q,q)$のローレンツ曲線は、直線であるため、$q$は任意の$p$についてthermo-majorizeされる。すなわち、
\begin{equation}
    \forall p \quad (q,q) \prec (p,q)
\end{equation}
である。したがって、thermo-majorizationは、確率分布$p$が$q$にどれだけ近いかを表す。\\
とくに、熱力学の文脈では$q$はあるハミルトニアン$H$のGibbs分布であり、$q=p^G$とかける。\footnote{任意のフルランクな$q$はあるハミルトニアンのGibbs分布であるらしい。}
このとき、$q=Tq$であるとは、$T$は、Gibbs分布を変えない遷移行列であるということである。このような遷移行列を、Gibbs-preserving mapという。\\
リソース理論の枠組みでは、GPMは、free operationとして扱われ、Gibbs分布は、free stateとして扱われる。\\

\begin{itembox}[l]{\textbf{Thm:遷移可能条件}}
    $p,q,p',q' \in \mathcal{P}_d$とし、$q,q'$がフルランクであるとする。このとき、以下の二つが成り立つ。
    \begin{enumerate}
        \item
        \begin{equation}
            (p',q') \prec (p,q) \Leftrightarrow S_0(p||q) \geq S_0(p'||q') \quad S_{\infty}(p||q) \leq S_{\infty}(p'||q')
        \end{equation}
        \item
        \begin{equation}
            S_{\infty}(p'||q') \leq S_{0}(p||q) \Leftrightarrow (p',q') \prec (p,q)
        \end{equation}
    \end{enumerate}

\end{itembox}
\textbf{Prf}\\
以下の図より明らかである。%TODO後で見る。\\
\begin{figure}[H]
    \begin{center}
    \includegraphics[width=100mm]{image3.png}
    \end{center}
    \caption{遷移可能条件の図示}
    \label{fig:three}
\end{figure}
上の定理から明らかなように、Rényi divergence の観点からは，状態遷移と d-majorization に関する必要条件と十分条件は一致しない。\\





\end{document}